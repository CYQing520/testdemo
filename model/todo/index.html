<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

</head>
<style>
    body {
    background: #F3E7B9;
    min-width: 775px;
    }

    .container {
    width: 80%;
    margin: 0 auto;
    }

    .tab {
    height: 100px;
    width: 600px;
    margin: 0 auto;
    }

    .tab div {
    width: 150px;
    float: left;
    font-size: 18px;
    border: 5px dotted #F96B36;
    padding: 10px;
    margin: 10px;
    text-align: center;
    }

    .tab span {
    color: #F96B36;
    }

    .add {
    cursor: pointer;
    color: #fff;
    width: 80px;
    height: 30px;
    border-radius: 5px;
    background: linear-gradient(#FF9B00, #FF7B00);
    border: 1px solid #EC7800;
    line-height: 30px;
    text-align: center;
    }

    .add:active {
    background: linear-gradient(#FF7B00, #FF9B00);
    }

    ul li {
    list-style: none;
    height: 50px;
    line-height: 50px;
    }

    .check {
    display: inline-block;
    width: 15px;
    height: 15px;
    border-radius: 50%;
    background-color: #ccc;
    cursor: pointer;
    }

    .bac {
    background-color: steelblue;
    }

    .line {
    text-decoration: line-through;
    color: #aaa;
    }

    .close {
    float: right;
    margin-right: 20px;
    color: #F96B36;
    cursor: pointer;
    height: 30px;
    }

    .model {
    width: 300px;
    height: 150px;
    background: #eee;
    padding: 10px;
    display: none;
    box-shadow: 0px 0px 20px #666;
    border-radius: 5px;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    }

    fieldset {
    border: 2px dashed #F96B36;
    height: 130px;
    }
    fieldset input {
    height: 40px;
    width: 80%;
    margin-top: 10px;
    margin-bottom: 10px;
    padding-left: 10px;
    }
    fieldset div {
    cursor: pointer;
    color: #fff;
    width: 80px;
    height: 30px;
    border-radius: 5px;
    background: linear-gradient(#FF9B00, #FF7B00);
    border: 1px solid #EC7800;
    line-height: 30px;
    text-align: center;
    float: right;
    margin: 10px;
    }
    fieldset div:active {
    background: linear-gradient(#FF7B00, #FF9B00);
    }
</style>

<body>
    <div class="container">
        <div id="head">
            <h2>备忘录</h2>
            <hr>
        </div>
        <div id="contain">
            <div class="tab">
                <div class="all">
                    全部事项
                    <span></span>
                    条
                </div>
                <div class="end">
                    已完成事项
                    <span></span>
                    条
                </div>
                <div class="noend">
                    未完成事项
                    <span></span>
                    条
                </div>
            </div>
            <div class="add">新增</div>
            <div class="alldata">
                <ul>

                </ul>
            </div>
        </div>
    </div>
    <div class="model model1">
        <fieldset>
            <legend>新增</legend>
            内容
            <input type="text" name="" id="">
            <div class="yes">确定</div>
            <div class="no">取消</div>
        </fieldset>
    </div>
    <div class="model model2">
        <fieldset>
            <legend>编辑</legend>
            内容
            <input type="text" name="" id="" placeholder="请输入">
            <div class="yes">确定</div>
            <div class="no">取消</div>
        </fieldset>
    </div>
    <script src="http://www.jq22.com/jquery/jquery-1.10.2.js"></script>
    <script>
        // 取数据
        var temp = localStorage.getItem("temp");
        // 若没有缓存
        if (temp == null) {
            // 模拟数据
            var alldata = [{
                    list: "eat",
                    status: 0
                },
                {
                    list: "sleep",
                    status: 1
                },
                {
                    list: "bitdou",
                    status: 0
                }
            ];
            // 数据存储
            localStorage.setItem("temp", JSON.stringify(alldata));
        }
        // 获取对象数据
        var listAll = JSON.parse(temp);

        redata();

        // 点击事件，改变状态，用事件代理
        $(".alldata ul").on("click", ".check", function () {
            var status;
            var index = $(this)
                .parent("li")
                .index();
            if ($(this).hasClass("bac")) {
                // 已完成变未完成
                status = 0;
            } else {
                // 未完成变已完成
                status = 1;
            }
            listAll[index].status = status;
            redata();
        });

        // 添加
        $(".add").on("click", function () {
            $(".model1 input").val("");
            $(".model1").show();
        });
        $(".model1 .yes").on("click", function () {
            var val = $(this)
                .prev()
                .val();
            if (val === "" || val == null || val == undefined) {} else {
                listAll.push({
                    list: val,
                    status: 0
                });
                redata();
                $(".model1").hide();
            }
        });

        // 编辑
        var indexmodel2;
        $(".alldata ul").on("click", ".edit", function () {
            $(".model2 input").val(
                $(this)
                .prev()
                .html()
            );
            $(".model2").show();
            indexmodel2 = $(this)
                .parent("li")
                .index();
        });
        $(".model2 .yes").on("click", function () {
            var val = $(this)
                .prev()
                .val();
            if (val === "" || val == null || val == undefined) {
                $(".model2").hide();
            } else {
                listAll[indexmodel2].list = val;
                redata();
                $(".model2").hide();
            }
        });
        // 取消隐藏
        $(".no").click(function () {
            $(".model").hide();
        });

        // 删除
        $(".alldata ul").on("click", ".close", function () {
            var index = $(this)
                .parent("li")
                .index();
            listAll.splice(index, 1);
            redata();
        });
        var adddate = "";

        function getTime() {
            var myDate = new Date();
            var year = myDate.getFullYear();
            var month = myDate.getMonth() + 1;
            var date = myDate.getDate();

            var hour = myDate.getHours();
            var minutes = myDate.getMinutes();
            var second = myDate.getSeconds();

            if (month < 10) {
                month = 0 + month;
            }
            if (date < 10) {
                date = 0 + date;
            }
            if (hour < 10) {
                hour = 0 + hour;
            }
            if (minutes < 10) {
                minutes = 0 + minutes;
            }
            if (second < 10) {
                second = 0 + second;
            }

            adddate = year + "年" + month + "月" + date + "日" + " " + hour + ":" + minutes + ":" + second;

        }
        // 渲染列表
        function redata() {
            var end = [];
            var noend = [];
            getTime();
            var str = "";
            for (var i = 0; i < listAll.length; i++) {
                if (listAll[i].status == 0) {
                    noend.push(listAll[i]);
                    str +=
                        `
            <li>
                <span class="check"></span>
                <span class="msg">` +
                        listAll[i].list +
                        `</span>
                <span class="edit">编辑</span>
                <span class="close">X</span>
                
            </li>
            `;
                } else {
                    end.push(listAll[i]);
                    str +=
                        `
            <li class="line">
                <span class="check bac"></span>
                <span class="msg">` +
                        listAll[i].list +
                        `</span>
                <span class="edit">编辑</span>
                <span class="close">X</span>
            </li>
            `;
                }
            }
            $(".alldata ul").html(str);
            $(".all span").html(listAll.length);
            $(".end span").html(end.length);
            $(".noend span").html(noend.length);
            localStorage.setItem("temp", JSON.stringify(listAll));
        }
    </script>
</body>

</html>